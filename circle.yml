machine:
  python:
    version: "3.5.2"

dependencies:
  pre:
    - pip install pytest pytest-cov
    - pip install flake8 flake8-docstrings
    - gem install fpm
  override:
    - pip install .

test:
  pre:
    - find . -name '__pycache__' | xargs rm -rf
  override:
    - mkdir -p $CIRCLE_TEST_REPORTS/pytest
    - py.test -v --cov=jacquard --junit-xml=$CIRCLE_TEST_REPORTS/pytest/junit.xml jacquard
    - flake8 --exclude=tests jacquard
  post:
    - ./hax_debian.sh
    - mv *.deb $CIRCLE_ARTIFACTS/
